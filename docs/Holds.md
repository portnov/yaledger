# Резервы (холды)

Каждый счёт может хранить набор резервов:

-   Кредитовые счета могут иметь кредитовые резервы
-   Дебетовые счета могут иметь дебетовые резервы
-   Свободные счета могут иметь как дебетовые, так и дебетовые резервы.

Балансы счёта вычисляются следующим образом:

-   Доступный остаток = Баланс - Дебетовые холды
-   Финансовый остаток = Баланс + Кредитовые холды

Резерв на счету создаётся записью вида:

    @ 2012/12/28
    hold dr /путь/к/счёту 100р

При создании холда ему присваиваются [атрибуты][Attributes] записи, создавшей холд.

Закрыть холд можно явно:

    @ 2012/12/29
    close dr /путь/к/счёту 100р

При закрытии холда на счету ищется холд того же типа (кредит/дебет), на
сумму, совпадающую с указанной. Если нужно закрыть любой холд на сумму, меньшую или равную указанной, то нужно это явно указать:

    @ 2012/12/30
    close <= dr /путь/к/счёту 1000р

Можно указать атрибуты холда, подлежащего закрытию:

    @ 2012/12/31
    close <= dr /путь/к/счёту 1000р with {category="коммунальные"}

Полный синтаксис записи:

    close [<=] {dr|cr} счёт сумма [with {name=value, ...}]

Кроме того, отдельные полупроводки могут использовать ранее
зарезервированные средства:

    @ 2012/09/01
    hold dr карточка 5000р

    @ 2012/09/30
    use dr карточка 4500р
     cr квартплата

В таком случае, перед выполнением полупроводки на счету ищется холд на
сумму, больше или равную сумме полупроводки. Если найден холд на ту же
сумму, то он закрывается. Если найден холд на большую сумму, то он
закрывается, и создаётся новый холд на разницу в суммах. Так, в
предыдущем примере будет найден и закрыт холд на сумму 5000р, и создан
новый холд на 500р.

Есть возможность использовать холд, если таковой имеется:

    @ 01/19
    try use dr карточка 5100р
            квартплата

В таком случае, будет предпринята попытка использовать холд на указанную сумму. Если подходящий холд не найден, то будет выдано предупреждение, а полупроводка будет использовать основные средства счёта.

[Attributes]: Attributes.md
