# Общий алгоритм работы

В общем случае YaLedger работает в следующем порядке:

1.  Загружает конфигурационные файлы, разбирает параметры
    [командной строки](CmdLine).
2.  Загружает записи из файлов, указанных в [yaledger.yaml](Config) и в
    командной строке. NB: порядок указания файлов не имеет никакого
    значения, см. ниже.
3.  Сортирует все загруженные записи по дате/времени (так что записи из
    разных файлов могут оказаться вперемешку, это штатная ситуация). NB:
    сортировка выполняется так, что записи с одинаковыми датой и
    временем, загруженные из одного файла, оказываются соседними.
4.  Проходит по списку загруженных записей и выполняет
    [обработку дублирующихся записей](Deduplication).
5.  Т.к. в результате такой обработки даты записей могли поменяться,
    сортирует записи по дате/времени ещё раз.
6.  Отбирает записи в соответствии с запросом (параметры командной
    строки `-s`, `-e`, `-a`).
7.  Выполняет обработку записей по порядку. При этом получается список
    транзакций, отсортированный по дате/времени. Одна запись может
    порождать несколько транзакций (например, запись `periodic`).
8.  Выполняет обработку получившихся транзакций по порядку. Обработка
    проводок описана на странице [Accounting](Accounting).
9.  После того, как все транзакции обработаны, запускает
    [отчёт](Reports), указанный в командной строке. Отчёт выводит
    результаты на stdout.

